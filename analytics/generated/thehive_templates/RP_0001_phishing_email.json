{"customFields": {}, "metrics": {}, "tlp": 2, "pap": 0, "tasks": [{"order": 0, "title": "1 | RA_1101_practice", "group": "preparation", "description": "Make sure that most of the Response Action has been performed on an internal exercise by your Incident Response team.\nYou need to make sure that when an Incident will happen, the team will not just try to follow the playbooks they see first time in their lives, but will be able to quickly execute the actual steps in **your environment**, i.e. blocking an IP address or a domain name. \n"}, {"order": 1, "title": "2 | RA_1102_take_trainings", "group": "preparation", "description": "> We do not rise to the level of our expectations. We fall to the level of our training.\n\nHere are some relevant training courses that will help you in the Incident Response activities:\n\n1. [Investigation Theory](https://chrissanders.org/training/investigationtheory/) by Chris Sanders. We recommend you to have it as a mandatory training for every member of your Incident Response team.\n2. [Offensive Security](https://www.offensive-security.com/courses-and-certifications/) trainings. We recommend [PWK](https://www.offensive-security.com/pwk-oscp/) to begin with.\n3. [SANS Digital Forensics & Incident Response](https://digital-forensics.sans.org/training/courses) trainings.\n\nOffensive Security trainings are in the list because to fight a threat, you need to understand their motivation, tactics, and techniques.\n\nAt the same time, we assume that you already have a strong technical background in fundamental disciplines \u2014 Networking, Operating Systems, and Programming.\n"}, {"order": 2, "title": "3 | RA_1104_make_personnel_report_suspicious_activity", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 3, "title": "4 | RA_1103_raise_personnel_awareness", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 4, "title": "5 | RA_1301_get_ability_to_find_all_users_opened_email", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 5, "title": "6 | RA_1302_get_ability_to_find_all_users_received_email", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 6, "title": "7 | RA_1303_get_ability_to_block_email_domain", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 7, "title": "8 | RA_1304_get_ability_to_block_email_sender", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 8, "title": "9 | RA_1305_get_ability_to_delete_email", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 9, "title": "10 | RA_1211_manage_border_firewall_rules", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 10, "title": "11 | RA_1213_manage_host_firewall_rules", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 11, "title": "12 | RA_1214_manage_dns_records", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 12, "title": "13 | RA_1215_manage_proxy_rules", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 13, "title": "14 | RA_1216_manage_ips_rules", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 14, "title": "15 | RA_1217_manage_ngfw_rules", "group": "preparation", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 15, "title": "16 | RA_2302_get_original_email", "group": "identification", "description": "Obtain the original email from one of the available/fastest options:\n\n- Email Team/Email server: if there is such option\n- Person who reported the attack (if it wasn't detected automatically or reported by victims)\n- Victims: if they reported the attack\n\nAsk for the email in `.EML` format. Instructions: \n\n  1. Drug and drop email from Email client to Desktop\n  2. Archive with password \"infected\" and send to IR specialists by email\n"}, {"order": 16, "title": "17 | RA_2301_list_users_opened_email", "group": "identification", "description": "Description of how to handle multiple Response Actions (if it is an aggregated Response Action) or workflow for single Response Action in markdown format.\nHere newlines will be saved.  \n"}, {"order": 17, "title": "18 | RA_2303_list_email_receivers", "group": "identification", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 18, "title": "19 | RA_2304_make_sure_email_is_a_phishing", "group": "identification", "description": "Check email and its metadata for evidences of phishing attack:\n\n- **Impersonalisation attempts**: sender is trying to identify himself as somebody he is not\n- **Suspicious askings or offers**: download \"invoice\", click on link with something important etc\n- **Psychological manipulations**: invoking a sense of urgency or fear is a common phishing tactic\n- **Spelling mistakes**: legitimate messages usually don't have spelling mistakes or poor grammar\n\nExplore references of the article to make yourself familiar with phishing attacks history and examples.\n"}, {"order": 19, "title": "20 | RA_2305_extract_observables_from_email", "group": "identification", "description": "Extract the data for further response steps:\n\n- attachments (using munpack tool: `munpack email.eml`)\n- from, to, cc\n- subject of the email\n- received servers path\n- list of URLs from the text content of the mail body and attachments\n\nThis Response Action could be automated with [TheHive EmlParser](https://blog.thehive-project.org/2018/07/31/emlparser-a-new-cortex-analyzer-for-eml-files/).\n"}, {"order": 20, "title": "21 | RA_2103_put_compromised_accounts_on_monitoring", "group": "identification", "description": "Start monitoring for authentification attempts and all potentially harmful actions from potentially compromised accounts.\nLook for anomalies, strange network connections, unusual geolocation/time of work, actions which were never executed before.\nKeep in touch with real users and in case of need ask them if they executing these actions by themselves or not.\n"}, {"order": 21, "title": "22 | RA_3202_block_IP_on_border_firewall", "group": "containment", "description": "Block ip address on border firewall using native filtering functionality.\nWarning: \n- If not all corporate hosts access internet through the border firewall, this Response Action cannot guarantee containment of threat.\n- Be careful blocking IP address. Make sure it's not cloud provider or hoster. In this case you have to use blocking by URL something more specific.\n"}, {"order": 22, "title": "23 | RA_3203_block_domain_on_DNS", "group": "containment", "description": "Block domain on DNS Server using native sinkholing functionality. \nWarning: \n- If corporate DNS usage is not mandatory and hosts can use public DNS servers (access is not blocked by firewall), this Response Action cannot guarantee containment of threat.\n- Be careful blocking IP address. Make sure it's not cloud provider or hoster. In this case you have to use blocking by URL something more specific."}, {"order": 23, "title": "24 | RA_3204_block_URL_on_proxy", "group": "containment", "description": "Block URL on Proxy Server using native filtering functionality. \nWarning: If corporate Proxy usage is not mandatory and clients can access internet bypassing it (direct access is not restricted by firewall), this Response Action cannot guarantee containment of threat."}, {"order": 24, "title": "25 | RA_3205_block_domain_on_IPS", "group": "containment", "description": "Block a domain on an IPS using its native filtering functionality.  \nWarning:  \n\n- If not all corporate hosts access the internet through the IPS, you will **not** be able to contain the threat using this Response Action.  \n- Be careful blocking domain names. Make sure it's not a cloud provider or a hoster. If you would like to block something that is hosted on a well-known cloud provider or on a big hoster domain, you should block a specific URL using alternative Response Action.  \n"}, {"order": 25, "title": "26 | RA_3206_block_domain_on_NGFW", "group": "containment", "description": "Block domain on NGFW using native filtering functionality.\nWarning: \n- If not all corporate hosts access internet through the NGFW, this Response Action cannot guarantee containment of threat.\n- Be careful blocking domain names. Make sure it's not cloud provider or hoster. In this case you have to use blocking by URL something more specific.\n"}, {"order": 26, "title": "27 | RA_3207_block_IP_on_IPS", "group": "containment", "description": "Block an IP address on an IPS using its native filtering functionality.  \nWarning:  \n\n- If not all corporate hosts access the internet through the IPS, you will **not** be able to contain the threat using this Response Action.  \n- Be careful blocking IP addresses. Make sure it's not a cloud provider or a hoster. If you would like to block something that is hosted on a well-known cloud provider or on a big hoster IP address, you should block a specific URL using alternative Response Action.  \n"}, {"order": 27, "title": "28 | RA_3208_block_IP_on_NGFW", "group": "containment", "description": "Block an IP address with NGFW using native filtering functionality.\nWarning: \n- If not all corporate hosts access internet through the NGFW, this Response Action cannot guarantee containment of threat.\n- Be careful blocking IP address. Make sure it's not cloud provider or hoster. In this case you have to use blocking by URL something more specific.\n"}, {"order": 28, "title": "29 | RA_3209_block_URL_on_NGFW", "group": "containment", "description": "Block URL on NGFW using native filtering functionality.\nWarning: If not all corporate hosts access internet through the NGFW, this Response Action cannot guarantee containment of threat.\n"}, {"order": 29, "title": "30 | RA_3301_block_domain_on_email", "group": "containment", "description": "Block malicious sender (or entire domain, if possible) on Email Server using native filtering functionality.\n"}, {"order": 30, "title": "31 | RA_3302_block_sender_on_email", "group": "containment", "description": "Description of the workflow for single Response Action in markdown format.\nHere newlines will be saved.\n"}, {"order": 31, "title": "32 | RA_4301_delete_malicious_emails", "group": "eradication", "description": "Delete malicious emails from Email Server and users' email boxes using native Email Server functionality.\n"}, {"order": 32, "title": "33 | RA_4701_revoke_compromised_credentials", "group": "eradication", "description": "On this step you supposed to know what kind of credentials have beed compromised.\nYou need to revoke them in your Identity and Access Management system where they were created (like, Windows AD) using native functionality.\nWarning:\n- If adversary has generated Golden Ticket in Windows Domain/forest, you have to revoke KRBTGT Account password **twice** for each domain in a forest and proceed monitor malicious activity for next 20 minutes (Domain Controller KDC service doesn\u2019t perform validate the user account until the TGT is older than 20 minutes old)\n"}, {"order": 33, "title": "34 | RA_4101_report_phishing_attack_to_external_companies", "group": "eradication", "description": "Report phishing attack to external companites:\n\n1. [National Computer Security Incident Response Teams (CSIRTs)](https://www.sei.cmu.edu/education-outreach/computer-security-incident-response-teams/national-csirts/)\n2. [U.S. government-operated website](http://www.us-cert.gov/nav/report_phishing.html)\n3. [Anti-Phishing Working Group (APWG)](http://antiphishing.org/report-phishing/)\n4. [Google Safe Browsing](https://safebrowsing.google.com/safebrowsing/report_phish/?hl=en)\n5. [The FBI's Intenet Crime Complaint Center (IC3)](https://www.ic3.gov/default.aspx)\n\nThis Response Action could be automated with [TheHive and MISP integration](https://blog.thehive-project.org/2017/06/19/thehive-cortex-and-misp-how-they-all-fit-together/).\n"}, {"order": 34, "title": "35 | RA_6101_develop_incident_report", "group": "lessons_learned", "description": "Develop Incident Report using your corporate template.\n\nIt should include:\n\n1. Executive Summary with short description of damage, actions taken, root cause, and key metrics (Time To Detect, Time To Respond, Time To Recover)\n2. Detailed timeline of adversary actions, mapped to [ATT&CK tactics](https://attack.mitre.org/tactics/enterprise/) (you can use [Kill Chain](https://en.wikipedia.org/wiki/Kill_chain), but 95% of all actions will be in Actions On Objective stage, which is not really representative, meaningfull and usefull)\n3. Detailed timeline of actions taken by Incident Responders\n4. Root Cause Analysis and Recommendations for improvements based on its conclusion\n5. List of specialists involved into Incident Response with their roles\n"}, {"order": 35, "title": "36 | RA_6102_conduct_lessons_learned_exercise", "group": "lessons_learned", "description": "This Lessons Learned phase evaluates the team's performance through each step. \nBasically, this takes the incident report and answers some basic questions:\n\n- What happened?\n- What did we do well?\n- What could we have done better?\n- What will we do differently next time?\n\nThe goal of the Lessons Learned phase is to discover how to make the next incident response go faster, smoother, or ideally never happen at all.\nKeep in mind that incident report is a key. If, for example, Time To Respond looks horrible, it was caused by some problem.\nThe only way to solve it is to bring it up and start working on it.\n"}], "description": "Description:\nResponse playbook for Phishing Email case\n\nWorkflow:\n1. Execute Response Actions step by step. Some of them directly connected, which means you will not be able to move forward not finishing the previous step. Some of them are redundant, as those that are related to the blocking a threat using network filtering systems (containment stage). You need to use only one of them\n2. Start executing containment and eradication stages concurrently with next identification steps, as soon as you will receive information about malicious hosts\n3. If phishing led to code execution or remote access to victim host, immediately start executing Generic Post Exploitation Incident Response Playbook\n4. Save all timestamps of implemented actions in Incident Report draft on the fly, it will save a lot of time\n", "name": "RP_0001_phishing_email", "status": "Ok", "severity": 2, "titlePrefix": "", "tags": ["attack.initial_access", "attack.t1193", "attack.t1192", "phishing"]}